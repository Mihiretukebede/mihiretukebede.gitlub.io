<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Aspire Data Solutions: Plotting regression model coefficients in a forest plot</title>

<meta property="description" itemprop="description" content="How to plot model coefficients in a forest plot."/>

<link rel="canonical" href="http://www.mihiretukebede.com/posts/2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot/"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-02-04"/>
<meta property="article:created" itemprop="dateCreated" content="2021-02-04"/>
<meta name="article:author" content="Mihiretu Kebede(PhD)"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Aspire Data Solutions: Plotting regression model coefficients in a forest plot"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="How to plot model coefficients in a forest plot."/>
<meta property="og:url" content="http://www.mihiretukebede.com/posts/2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot/"/>
<meta property="og:image" content="http://www.mihiretukebede.com/posts/2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot/2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-23-1.png"/>
<meta property="og:image:width" content="1248"/>
<meta property="og:image:height" content="768"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Aspire Data Solutions"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Aspire Data Solutions: Plotting regression model coefficients in a forest plot"/>
<meta property="twitter:description" content="How to plot model coefficients in a forest plot."/>
<meta property="twitter:url" content="http://www.mihiretukebede.com/posts/2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot/"/>
<meta property="twitter:image" content="http://www.mihiretukebede.com/posts/2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot/2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-23-1.png"/>
<meta property="twitter:image:width" content="1248"/>
<meta property="twitter:image:height" content="768"/>

<!--  https://scholar.google.com/intl/en/scholar/inclusion.html#indexing -->
<meta name="citation_title" content="Aspire Data Solutions: Plotting regression model coefficients in a forest plot"/>
<meta name="citation_fulltext_html_url" content="http://www.mihiretukebede.com/posts/2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot/"/>
<meta name="citation_online_date" content="2021/02/04"/>
<meta name="citation_publication_date" content="2021/02/04"/>
<meta name="citation_author" content="Mihiretu Kebede(PhD)"/>
<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","title","categories","date","theme","author","url","google_analytics","description","collections","output","citation_url","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Aspire Data Solutions"]},{"type":"character","attributes":{},"value":["Plotting regression model coefficients in a forest plot"]},{"type":"character","attributes":{},"value":["Data Science"]},{"type":"character","attributes":{},"value":["February 4, 2021"]},{"type":"character","attributes":{},"value":["theme.css"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Mihiretu Kebede(PhD)"]}]}]},{"type":"character","attributes":{},"value":["http://www.mihiretukebede.com/"]},{"type":"character","attributes":{},"value":["UA-173027539-1"]},{"type":"character","attributes":{},"value":["How to plot model coefficients in a forest plot."]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["posts"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["share"]}},"value":[{"type":"character","attributes":{},"value":["twitter","linkedin","facebook","google-plus","pinterest"]}]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","encoding","widerscreen"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["UTF-8"]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["http://www.mihiretukebede.com/posts/2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot/"]},{"type":"character","attributes":{},"value":["http://www.mihiretukebede.com/posts/2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/anchor-4.2.2/anchor.min.js","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/bowser-1.9.3/bowser.min.js","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/distill-2.2.21/template.v2.js","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-12-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-13-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-15-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-16-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-17-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-18-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-19-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-19-2.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-20-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-21-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-22-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-22-2.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-23-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-24-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-25-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-26-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-27-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-28-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-3-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-30-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-31-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-32-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-33-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-34-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-35-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-5-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-5-2.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-6-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-8-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-8-2.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-9-1.png","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/header-attrs-2.20/header-attrs.js","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/jquery-3.6.0/jquery-3.6.0.js","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/jquery-3.6.0/jquery-3.6.0.min.js","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/jquery-3.6.0/jquery-3.6.0.min.map","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/popper-2.6.0/popper.min.js","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/tippy-6.2.7/tippy-bundle.umd.min.js","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/tippy-6.2.7/tippy-light-border.css","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/tippy-6.2.7/tippy.css","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/tippy-6.2.7/tippy.umd.min.js","2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/webcomponents-2.0.0/webcomponents.js","life_expectancy.csv","meskelflower.jpg"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

/* tweak for Pandoc numbered line within distill */
d-article pre.numberSource code > span {
    left: -2em;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme, except when numbering line
  // in code chunk
  $('pre:not(.numberLines) code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.20/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<link rel="icon" href="/images/favicon.ico" sizes="any">

<script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=UA-173027539-1"></script>
<script type="text/javascript" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-173027539-1');
</script>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Plotting regression model coefficients in a forest plot","description":"How to plot model coefficients in a forest plot.","authors":[{"author":"Mihiretu Kebede(PhD)","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-02-04T00:00:00.000+01:00","citationText":"Kebede(PhD), 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<span class="logo">
<img src="../../images/aspire-logo-1.jpg"/>
</span>
<a href="../../index.html" class="title">Aspire Data Solutions</a>
<a href="../../home.html">Home</a>
<a href="../../about.html">About</a>
<a href="../../subscribe.html">Subscribe</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../contact.html">
<i class="fa fa-envelope fa-lg" aria-hidden="true"></i>
</a>
<a href="https://www.youtube.com/channel/UCpHd6O1Yqz4YgcYUBfyRqKg">
<i class="fab fa-youtube" aria-hidden="true"></i>
</a>
<a href="https://github.com/Mihiretukebede/mihiretukebede.github.io">
<i class="fa fa-github fa-lg" aria-hidden="true"></i>
</a>
<a href="https://twitter.com/MihiretuKebede1">
<i class="fa fa-twitter fa-lg" aria-hidden="true"></i>
</a>
<a href="https://www.linkedin.com/in/mihiretu-m-kebede-18831b70/">
<i class="fa fa-linkedin fa-lg" aria-hidden="true"></i>
</a>
<a href="https://orcid.org/0000-0002-5599-2823">ORCID</a>
<a href="https://scholar.google.de/citations?user=O93Icv4AAAAJ&amp;hl=en">Google Scholar</a>
<a href="https://www.researchgate.net/profile/Mihiretu_Kebede2">ResearchGate</a>
<a href="../../index.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Plotting regression model coefficients in a forest plot</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:Data_Science" class="dt-tag">Data Science</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>How to plot model coefficients in a forest plot.</p></p>
</div>

<div class="d-byline">
  
  Mihiretu Kebede(PhD)
  
<br/>February 4, 2021
</div>

<div class="d-article">
<head>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4447780400240825" crossorigin="anonymous"></script>
</head>
<p>The detail description of this blog is also available in my <a href="https://www.youtube.com/watch?v=WgIqCRPZcZE">YouTube channel.</a>. Each content of this blog were based on my three YouTube videos embedded below. I highly recommend watching them.</p>
<p>Part 1</p>
<div class="layout-chunk" data-layout="l-body">
<iframe width="560" height="315" src="https://www.youtube.com/embed/WgIqCRPZcZE" frameborder="0" allowfullscreen=""></iframe>
</div>
<p>Part 2</p>
<div class="layout-chunk" data-layout="l-body">
<iframe width="560" height="315" src="https://www.youtube.com/embed/NKZOrMisgtc" frameborder="0" allowfullscreen=""></iframe>
</div>
<p>Part 3</p>
<div class="layout-chunk" data-layout="l-body">
<iframe width="560" height="315" src="https://www.youtube.com/embed/HmBXBTFPMB4" frameborder="0" allowfullscreen=""></iframe>
</div>
<h1 id="motivation">Motivation</h1>
<p>A friend of mine asked me to plot regression coefficients or odds ratios/risk ratios on a forest plots. Since my favorite part of data analysis is visualization, I happily took the challenge. R is a great language for powerful visualizations. As I promised in my previous blog post, I will describe how to visualize model coefficients/OR/RR in R. and their confidence intervals. For today, I will perform linear regression and logistic regression models. Then, I will extract coefficients(for linear regression) and ORs (for logistic regression). Many may prefer to present their analysis in tables. Compared to long and messy tables, plots can help us to quickly see patterns and grasp the the idea.</p>
<p>A great novelist may use fancy words to describe the beauty of Afework Tekele’s “Meskel Flower”, but it can never be as memorable as the 1959’s Afework Tekle’s master piece.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-4"></span>
<img src="meskelflower.jpg" alt="Meskel Flower by Afework Tekle, 1959" width="417" />
<p class="caption">
Figure 1: Meskel Flower by Afework Tekle, 1959
</p>
</div>
</div>
<h1 id="data">Data</h1>
<p>The data that I will use for this blog post is from the Global Health Observatory (GHO) data repository. The data is publicly available data and has collected some economic and health related variables a long the years for 193 WHO member states. I will also use this data for my future post about missing value imputation methods. You are free to download a copy of this data from my GitHub repository or from the original source.</p>
<p>I will use the <code>readr</code>package to read the csv file and use glm and lm to do the linear regression and logistic regression modeling. I will mention other relevant packages and their use along the way.</p>
<h1 id="load-the-data">Load the data</h1>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://readr.tidyverse.org'>readr</a></span><span class='op'>)</span> <span class='co'>#for reading the csv file</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span> <span class='co'>#for data manipulation</span></span>
<span><span class='va'>life_expe</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/readr/man/read_delim.html'>read_csv</a></span><span class='op'>(</span><span class='st'>"life_expectancy.csv"</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>life_expe</span><span class='op'>)</span> </span></code></pre>
</div>
<pre><code> [1] &quot;Country&quot;                        
 [2] &quot;Year&quot;                           
 [3] &quot;Status&quot;                         
 [4] &quot;Life expectancy&quot;                
 [5] &quot;Adult Mortality&quot;                
 [6] &quot;infant deaths&quot;                  
 [7] &quot;Alcohol&quot;                        
 [8] &quot;percentage expenditure&quot;         
 [9] &quot;Hepatitis B&quot;                    
[10] &quot;Measles&quot;                        
[11] &quot;BMI&quot;                            
[12] &quot;under-five deaths&quot;              
[13] &quot;Polio&quot;                          
[14] &quot;Total expenditure&quot;              
[15] &quot;Diphtheria&quot;                     
[16] &quot;HIV/AIDS&quot;                       
[17] &quot;GDP&quot;                            
[18] &quot;Population&quot;                     
[19] &quot;thinness  1-19 years&quot;           
[20] &quot;thinness 5-9 years&quot;             
[21] &quot;Income composition of resources&quot;
[22] &quot;Schooling&quot;                      </code></pre>
</div>
<p>Look at the variable names. They are not syntactically valid. That is why R puts variables inside the back tick and forward tick signs. I will use my favorite data cleaning package <em>janitor</em>, to quickly clean that messy variable naming with just one magically powerful function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/sfirke/janitor'>janitor</a></span><span class='op'>)</span></span>
<span><span class='va'>life_expe_data</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/janitor/man/clean_names.html'>clean_names</a></span><span class='op'>(</span><span class='va'>life_expe</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>life_expe_data</span><span class='op'>)</span> <span class='co'># All variables names are automagically cleaned!</span></span></code></pre>
</div>
<pre><code> [1] &quot;country&quot;                        
 [2] &quot;year&quot;                           
 [3] &quot;status&quot;                         
 [4] &quot;life_expectancy&quot;                
 [5] &quot;adult_mortality&quot;                
 [6] &quot;infant_deaths&quot;                  
 [7] &quot;alcohol&quot;                        
 [8] &quot;percentage_expenditure&quot;         
 [9] &quot;hepatitis_b&quot;                    
[10] &quot;measles&quot;                        
[11] &quot;bmi&quot;                            
[12] &quot;under_five_deaths&quot;              
[13] &quot;polio&quot;                          
[14] &quot;total_expenditure&quot;              
[15] &quot;diphtheria&quot;                     
[16] &quot;hiv_aids&quot;                       
[17] &quot;gdp&quot;                            
[18] &quot;population&quot;                     
[19] &quot;thinness_1_19_years&quot;            
[20] &quot;thinness_5_9_years&quot;             
[21] &quot;income_composition_of_resources&quot;
[22] &quot;schooling&quot;                      </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/pillar/man/glimpse.html'>glimpse</a></span><span class='op'>(</span><span class='va'>life_expe_data</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Rows: 2,938
Columns: 22
$ country                         &lt;chr&gt; &quot;Afghanistan&quot;, &quot;Afghanistan&quot;~
$ year                            &lt;dbl&gt; 2015, 2014, 2013, 2012, 2011~
$ status                          &lt;chr&gt; &quot;Developing&quot;, &quot;Developing&quot;, ~
$ life_expectancy                 &lt;dbl&gt; 65.0, 59.9, 59.9, 59.5, 59.2~
$ adult_mortality                 &lt;dbl&gt; 263, 271, 268, 272, 275, 279~
$ infant_deaths                   &lt;dbl&gt; 62, 64, 66, 69, 71, 74, 77, ~
$ alcohol                         &lt;dbl&gt; 0.01, 0.01, 0.01, 0.01, 0.01~
$ percentage_expenditure          &lt;dbl&gt; 71.279624, 73.523582, 73.219~
$ hepatitis_b                     &lt;dbl&gt; 65, 62, 64, 67, 68, 66, 63, ~
$ measles                         &lt;dbl&gt; 1154, 492, 430, 2787, 3013, ~
$ bmi                             &lt;dbl&gt; 19.1, 18.6, 18.1, 17.6, 17.2~
$ under_five_deaths               &lt;dbl&gt; 83, 86, 89, 93, 97, 102, 106~
$ polio                           &lt;dbl&gt; 6, 58, 62, 67, 68, 66, 63, 6~
$ total_expenditure               &lt;dbl&gt; 8.16, 8.18, 8.13, 8.52, 7.87~
$ diphtheria                      &lt;dbl&gt; 65, 62, 64, 67, 68, 66, 63, ~
$ hiv_aids                        &lt;dbl&gt; 0.1, 0.1, 0.1, 0.1, 0.1, 0.1~
$ gdp                             &lt;dbl&gt; 584.25921, 612.69651, 631.74~
$ population                      &lt;dbl&gt; 33736494, 327582, 31731688, ~
$ thinness_1_19_years             &lt;dbl&gt; 17.2, 17.5, 17.7, 17.9, 18.2~
$ thinness_5_9_years              &lt;dbl&gt; 17.3, 17.5, 17.7, 18.0, 18.2~
$ income_composition_of_resources &lt;dbl&gt; 0.479, 0.476, 0.470, 0.463, ~
$ schooling                       &lt;dbl&gt; 10.1, 10.0, 9.9, 9.8, 9.5, 9~</code></pre>
</div>
<p>The above result shows the data has about 22 columns(variables) and 2928 rows(observations). Let me do a quick exploratory data analysis .</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://boxuancui.github.io/DataExplorer/'>DataExplorer</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/DataExplorer/man/plot_missing.html'>plot_missing</a></span><span class='op'>(</span><span class='va'>life_expe_data</span><span class='op'>)</span> </span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-6-1.png" width="624" /></p>
</div>
<p>The missing value exploration plot shows, we don’t have missing value of more than 25% for each variable. We don’t have any variable that will be dropped using a complete deletion. In fact, the missing values are tolerable and performing imputation strategies is practically possible. I will be back on another blog post to perform missing value imputations using tree-based methods or KNN algorithms. For now, I will simply drop all observations with missing values!</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>life_exp_narm</span> <span class='op'>&lt;-</span> <span class='va'>life_expe_data</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/stats/complete.cases.html'>complete.cases</a></span><span class='op'>(</span><span class='va'>life_expe_data</span><span class='op'>)</span>, <span class='op'>]</span> <span class='co'># This deletes all rows with missing values</span></span></code></pre>
</div>
</div>
<p>There is another important function from the <code>DataExplorer</code>package to do a quick grasp of the distributions of my variables.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/DataExplorer/man/plot_histogram.html'>plot_histogram</a></span><span class='op'>(</span><span class='va'>life_exp_narm</span><span class='op'>)</span> <span class='co'># Almost all variables are skewed</span></span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-8-1.png" width="624" /><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-8-2.png" width="624" /></p>
</div>
<h1 id="modeling">Modeling</h1>
<p>Since, the goal of this post is to plot model coefficients and confidence intervals in a forest plot, I will not go deeper in explaining models.I will use life expectancy as a dependent variable and use some predictors to do my linear models. Before that, I will do one quick visualization.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span> <span class='co'>#for awesome plotting</span></span>
<span></span>
<span><span class='co'># let me rename the income variable</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>life_exp_narm</span><span class='op'>)</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>life_exp_narm</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"income_composition_of_resources"</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='st'>"income_index"</span></span>
<span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>life_exp_narm</span>, <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>income_index</span>, y<span class='op'>=</span><span class='va'>life_expectancy</span>, col<span class='op'>=</span><span class='va'>status</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> </span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<p>The plot shows, as income index increases, life expectancy increases. In addition, the developed countries have higher income level and high life expectancy. However, there is really one very important thing visible in this plot. The income_index variable has a lot of zeros values.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>life_exp_narm</span><span class='op'>$</span><span class='va'>income_index</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.5090  0.6730  0.6316  0.7510  0.9360 </code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>life_exp_narm</span><span class='op'>$</span><span class='va'>income_index</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>)</span> </span></code></pre>
</div>
<pre><code>[1] 48</code></pre>
</div>
<p>See, 48 observations have 0 value on income_index. That must be missing data. I will filter out the observations with 0 values in this variable.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>life_exp_new</span> <span class='op'>&lt;-</span> <span class='va'>life_exp_narm</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>income_index</span><span class='op'>&gt;</span><span class='fl'>0</span><span class='op'>)</span> <span class='co'># all with 0 values on income_index variable are removed</span></span></code></pre>
</div>
</div>
<p>Now, we can visualize again with a little more tweaking.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>life_exp_new</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>income_index</span>, y<span class='op'>=</span><span class='va'>life_expectancy</span>, col<span class='op'>=</span><span class='va'>status</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_smooth.html'>geom_smooth</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"lm"</span>, col<span class='op'>=</span><span class='st'>"blue"</span><span class='op'>)</span> </span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-12-1.png" width="624" /></p>
</div>
<p>We have now somehow clean data to start our modeling process. We may need to see the relations ship of income index with other variables. For now, I will skip that and directly proceed to my modeling.</p>
<h1 id="different-ways-similar-results">Different ways, similar results</h1>
<p>One of the great things, you can enjoy with R is there are many ways of doing the same thing.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lm1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>life_expectancy</span> <span class='op'>~</span> <span class='va'>total_expenditure</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>income_index</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>adult_mortality</span> <span class='op'>+</span> <span class='va'>infant_deaths</span> <span class='op'>+</span> <span class='va'>alcohol</span> <span class='op'>+</span> <span class='va'>thinness_1_19_years</span> <span class='op'>+</span> <span class='va'>thinness_5_9_years</span> <span class='op'>+</span> <span class='va'>schooling</span> <span class='op'>+</span> <span class='va'>infant_deaths</span> <span class='op'>+</span> <span class='va'>status</span>,data<span class='op'>=</span><span class='va'>life_exp_new</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># We can do the same task using glm but defining the family argument as "gaussian"</span></span>
<span><span class='va'>lm2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>life_expectancy</span> <span class='op'>~</span> <span class='va'>total_expenditure</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>income_index</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>adult_mortality</span> <span class='op'>+</span> <span class='va'>infant_deaths</span> <span class='op'>+</span> <span class='va'>alcohol</span> <span class='op'>+</span> <span class='va'>thinness_1_19_years</span> <span class='op'>+</span> <span class='va'>thinness_5_9_years</span> <span class='op'>+</span> <span class='va'>schooling</span> <span class='op'>+</span> <span class='va'>infant_deaths</span> <span class='op'>+</span> <span class='va'>status</span>,</span>
<span>           data<span class='op'>=</span><span class='va'>life_exp_new</span>, family <span class='op'>=</span> <span class='va'>gaussian</span><span class='op'>)</span></span></code></pre>
</div>
</div>
<h1 id="see-the-model-outputs">See the model outputs</h1>
<p>The two approach produce similar outputs. But,<strong>lm</strong> has a shorter code than glm. So, many ppl prefer to use lm() for linear regression.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://jtools.jacob-long.com'>jtools</a></span><span class='op'>)</span> <span class='co'>#for nice table model output</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/jtools/man/summ.html'>summ</a></span><span class='op'>(</span><span class='va'>lm1</span>,confint <span class='op'>=</span> <span class='cn'>TRUE</span>, digits <span class='op'>=</span> <span class='fl'>3</span>, vifs <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='co'># add vif to see if variance inflation factor is greater than 2</span></span></code></pre>
</div>
<pre><code>MODEL INFO:
Observations: 1601
Dependent Variable: life_expectancy
Type: OLS linear regression 

MODEL FIT:
F(9,1591) = 883.694, p = 0.000
R² = 0.833
Adj. R² = 0.832 

Standard errors: OLS
----------------------------------------------------------------------
                              Est.     2.5%    97.5%    t val.       p
------------------------- -------- -------- -------- --------- -------
(Intercept)                 94.878   92.149   97.606    68.214   0.000
total_expenditure            0.227    0.144    0.311     5.365   0.000
log(income_index)           29.194   27.340   31.047    30.897   0.000
adult_mortality             -0.021   -0.023   -0.020   -23.933   0.000
infant_deaths               -0.001   -0.002    0.001    -0.653   0.514
alcohol                     -0.246   -0.310   -0.181    -7.494   0.000
thinness_1_19_years          0.081   -0.024    0.186     1.507   0.132
thinness_5_9_years          -0.186   -0.290   -0.083    -3.546   0.000
schooling                   -0.512   -0.674   -0.351    -6.220   0.000
statusDeveloping            -2.289   -2.940   -1.637    -6.890   0.000
----------------------------------------------------------------------
 
---------------------------------
                              VIF
------------------------- -------
(Intercept)                      
total_expenditure           1.138
log(income_index)           6.779
adult_mortality             1.540
infant_deaths               1.369
alcohol                     2.131
thinness_1_19_years         7.147
thinness_5_9_years          6.961
schooling                   6.389
statusDeveloping            1.716
---------------------------------</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/jtools/man/summ.html'>summ</a></span><span class='op'>(</span><span class='va'>lm2</span>,confint <span class='op'>=</span> <span class='cn'>TRUE</span>, digits <span class='op'>=</span> <span class='fl'>3</span>, vifs<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>MODEL INFO:
Observations: 1601
Dependent Variable: life_expectancy
Type: Linear regression 

MODEL FIT:
&lt;U+03C7&gt;²(9) = 105053.208, p = 0.000
Pseudo-R² (Cragg-Uhler) = 0.834
Pseudo-R² (McFadden) = 0.249
AIC = 8687.410, BIC = 8746.572 

Standard errors: MLE
----------------------------------------------------------------------
                              Est.     2.5%    97.5%    t val.       p
------------------------- -------- -------- -------- --------- -------
(Intercept)                 94.878   92.151   97.604    68.214   0.000
total_expenditure            0.227    0.144    0.310     5.365   0.000
log(income_index)           29.194   27.342   31.046    30.897   0.000
adult_mortality             -0.021   -0.023   -0.020   -23.933   0.000
infant_deaths               -0.001   -0.002    0.001    -0.653   0.514
alcohol                     -0.246   -0.310   -0.181    -7.494   0.000
thinness_1_19_years          0.081   -0.024    0.186     1.507   0.132
thinness_5_9_years          -0.186   -0.289   -0.083    -3.546   0.000
schooling                   -0.512   -0.674   -0.351    -6.220   0.000
statusDeveloping            -2.289   -2.940   -1.638    -6.890   0.000
----------------------------------------------------------------------
 
---------------------------------
                              VIF
------------------------- -------
(Intercept)                      
total_expenditure           1.138
log(income_index)           6.779
adult_mortality             1.540
infant_deaths               1.369
alcohol                     2.131
thinness_1_19_years         7.147
thinness_5_9_years          6.961
schooling                   6.389
statusDeveloping            1.716
---------------------------------

Estimated dispersion parameter = 13.209 </code></pre>
</div>
<p>Seeing the vif value above 2 is evidence of multicollinearity in our model. Let’s just use the HMISC package to find all correlation values for the variables in the model.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>life_exp_narm</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/select.html'>select</a></span><span class='op'>(</span><span class='va'>total_expenditure</span>, <span class='va'>income_index</span>, <span class='va'>adult_mortality</span> , <span class='va'>infant_deaths</span> ,</span>
<span>             <span class='va'>alcohol</span>, <span class='va'>thinness_1_19_years</span>, <span class='va'>thinness_5_9_years</span>, <span class='va'>schooling</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'>#library(corrplot)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://hbiostat.org/R/Hmisc/'>Hmisc</a></span><span class='op'>)</span></span>
<span><span class='va'>cor</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/Hmisc/man/rcorr.html'>rcorr</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>as.matrix</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>r</span> <span class='op'>&lt;-</span> <span class='va'>cor</span><span class='op'>$</span><span class='va'>r</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/table.html'>as.table</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>r</span></span></code></pre>
</div>
<pre><code>                    total_expenditure income_index adult_mortality
total_expenditure          1.00000000   0.18365319     -0.08522653
income_index               0.18365319   1.00000000     -0.44220329
adult_mortality           -0.08522653  -0.44220329      1.00000000
infant_deaths             -0.14695112  -0.13475386      0.04245024
alcohol                    0.21488509   0.56107433     -0.17553509
thinness_1_19_years       -0.20987232  -0.45367885      0.27223004
thinness_5_9_years        -0.21786479  -0.43848372      0.28672288
schooling                  0.24378345   0.78474058     -0.42117052
                    infant_deaths     alcohol thinness_1_19_years
total_expenditure     -0.14695112  0.21488509         -0.20987232
income_index          -0.13475386  0.56107433         -0.45367885
adult_mortality        0.04245024 -0.17553509          0.27223004
infant_deaths          1.00000000 -0.10621692          0.46341526
alcohol               -0.10621692  1.00000000         -0.40375499
thinness_1_19_years    0.46341526 -0.40375499          1.00000000
thinness_5_9_years     0.46190792 -0.38620819          0.92791344
schooling             -0.21437190  0.61697481         -0.49119921
                    thinness_5_9_years   schooling
total_expenditure          -0.21786479  0.24378345
income_index               -0.43848372  0.78474058
adult_mortality             0.28672288 -0.42117052
infant_deaths               0.46190792 -0.21437190
alcohol                    -0.38620819  0.61697481
thinness_1_19_years         0.92791344 -0.49119921
thinness_5_9_years          1.00000000 -0.47248203
schooling                  -0.47248203  1.00000000</code></pre>
</div>
<p>Or more beautifully we can plot he correlation values using the <em><code>pairs.panels</code></em> function from the <code>psych</code> package. We can have a good correlation matrix of our variables.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://personality-project.org/r/psych/'>psych</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/psych/man/pairs.panels.html'>pairs.panels</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-16-1.png" width="624" /></p>
</div>
<p>There is a high correlation(r=.93) between thinness_1_19_years and thinness_5_9_years, schooling and income_index (r=0.78), schooling and alchohol. To deal with this multicollinearity problem, I will just drop one of the collinear variables because they just add a redundenent information in my model. Ideally, one can do a stepwise regression, or best subsets regression and then choose the model that has the highest R-squared value. But, we are simply dropping one of the variables. Let me drop <em>thinness_5_9_years</em> (the variable <em>thinness_1_19_years</em> actually carry the other variable: <em>thinness_5_9_years</em>), and <em>income_index</em> variables from my linear model and redo my analysis.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>lm3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>life_expectancy</span> <span class='op'>~</span> <span class='va'>total_expenditure</span> <span class='op'>+</span> </span>
<span>             <span class='va'>schooling</span> <span class='op'>+</span> <span class='va'>adult_mortality</span> <span class='op'>+</span> <span class='va'>infant_deaths</span> <span class='op'>+</span> <span class='va'>thinness_1_19_years</span> <span class='op'>+</span></span>
<span>            <span class='va'>alcohol</span> <span class='op'>+</span> <span class='va'>status</span>,</span>
<span>          data<span class='op'>=</span><span class='va'>life_exp_new</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/jtools/man/summ.html'>summ</a></span><span class='op'>(</span><span class='va'>lm3</span>,confint <span class='op'>=</span> <span class='cn'>TRUE</span>, digits <span class='op'>=</span> <span class='fl'>3</span>, vifs<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> </span></code></pre>
</div>
<pre><code>MODEL INFO:
Observations: 1601
Dependent Variable: life_expectancy
Type: OLS linear regression 

MODEL FIT:
F(7,1593) = 623.404, p = 0.000
R² = 0.733
Adj. R² = 0.731 

Standard errors: OLS
----------------------------------------------------------------------
                              Est.     2.5%    97.5%    t val.       p
------------------------- -------- -------- -------- --------- -------
(Intercept)                 59.180   57.252   61.107    60.223   0.000
total_expenditure           -0.027   -0.130    0.076    -0.509   0.611
schooling                    1.558    1.440    1.677    25.746   0.000
adult_mortality             -0.033   -0.035   -0.031   -31.411   0.000
infant_deaths                0.001   -0.002    0.003     0.566   0.571
thinness_1_19_years         -0.214   -0.280   -0.148    -6.373   0.000
alcohol                     -0.146   -0.227   -0.065    -3.532   0.000
statusDeveloping            -1.725   -2.548   -0.902    -4.111   0.000
----------------------------------------------------------------------
 
---------------------------------
                              VIF
------------------------- -------
(Intercept)                      
total_expenditure           1.090
schooling                   2.153
adult_mortality             1.288
infant_deaths               1.345
thinness_1_19_years         1.736
alcohol                     2.110
statusDeveloping            1.709
---------------------------------</code></pre>
</div>
<p>Now, I don’t have much evidence of multicollinearity (see the vif values). BINGO!</p>
<p>There are many ways of visualizing my model outputs.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://broom.tidymodels.org/'>broom</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://cli.r-lib.org'>cli</a></span><span class='op'>)</span></span>
<span><span class='va'>model_output</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/generics/man/tidy.html'>tidy</a></span><span class='op'>(</span><span class='va'>lm3</span><span class='op'>)</span></span>
<span><span class='va'>out_conf</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/generics/man/tidy.html'>tidy</a></span><span class='op'>(</span><span class='va'>lm3</span>, conf.int <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></span>
<span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/sollano/forestmangr#readme'>forestmangr</a></span><span class='op'>)</span></span>
<span><span class='va'>lm_model_out</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/forestmangr/man/round_df.html'>round_df</a></span><span class='op'>(</span><span class='va'>out_conf</span>, digits<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span></span>
<span><span class='va'>lm_model_out</span> <span class='op'>&lt;-</span> <span class='va'>lm_model_out</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span>,<span class='op'>]</span> <span class='co'>#remove the intercept </span></span>
<span></span>
<span><span class='co'># Now plot them</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='va'>lm_model_out</span>, <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>term</span>, <span class='va'>estimate</span><span class='op'>)</span>, y<span class='op'>=</span><span class='va'>estimate</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>         <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_linerange.html'>geom_errorbar</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/aes.html'>aes</a></span><span class='op'>(</span>ymin<span class='op'>=</span><span class='va'>conf.low</span>, ymax<span class='op'>=</span><span class='va'>conf.high</span><span class='op'>)</span>, </span>
<span>                       width <span class='op'>=</span> <span class='fl'>0.2</span>,size  <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>                       position <span class='op'>=</span> <span class='st'>"dodge"</span>, color<span class='op'>=</span><span class='st'>"turquoise4"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>, color <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_point.html'>geom_point</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/coord_flip.html'>coord_flip</a></span><span class='op'>(</span><span class='op'>)</span> </span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-18-1.png" width="624" /></p>
</div>
<p><strong>Retrieve coefficients and their 95% CI</strong></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>coef</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>lm3</span><span class='op'>)</span></span>
<span><span class='va'>ConfidenceInterval</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>lm3</span><span class='op'>)</span></span>
<span><span class='va'>coef_confint</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>coef</span>, <span class='va'>ConfidenceInterval</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span><span class='va'>coef_confint</span> <span class='op'>&lt;-</span> <span class='va'>coef_confint</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span> <span class='fu'><a href='https://rdrr.io/pkg/plyr/man/mutate.html'>mutate</a></span><span class='op'>(</span>variable<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>coef_confint</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://had.co.nz/plyr'>plyr</a></span><span class='op'>)</span> </span>
<span><span class='va'>coef_confint</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/plyr/man/rename.html'>rename</a></span><span class='op'>(</span><span class='va'>coef_confint</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"coef"</span> <span class='op'>=</span> <span class='st'>"Beta"</span>,</span>
<span>                                      `2.5 %` <span class='op'>=</span> <span class='st'>"lower_bound"</span>, </span>
<span>                                      `97.5 %` <span class='op'>=</span> <span class='st'>"upper_bound"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># We don't need to plot the intercept. We can remove it from our data</span></span>
<span></span>
<span></span>
<span><span class='co'># Reorder variables</span></span>
<span><span class='va'>col_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"variable"</span>, <span class='st'>"Beta"</span>, <span class='st'>"lower_bound"</span>, <span class='st'>"upper_bound"</span><span class='op'>)</span></span>
<span><span class='va'>coef_confint</span> <span class='op'>&lt;-</span> <span class='va'>coef_confint</span><span class='op'>[</span>, <span class='va'>col_order</span><span class='op'>]</span> <span class='co'>#reorder variables in the data frame</span></span>
<span></span>
<span><span class='va'>coef_confint</span> <span class='op'>&lt;-</span> <span class='va'>coef_confint</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate_all.html'>mutate_if</a></span><span class='op'>(</span><span class='va'>is.numeric</span>, <span class='va'>round</span>, digits <span class='op'>=</span> <span class='fl'>2</span><span class='op'>)</span> <span class='co'># round numeric into two significant digits </span></span></code></pre>
</div>
</div>
<h1 id="visualize-the-coefficients-once-again">Visualize the coefficients once again</h1>
<p>Now, I have everything to visualize my coefficients and their respective confidence intervals in a forest plot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_lm</span> <span class='op'>&lt;-</span> <span class='va'>coef_confint</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span>,<span class='op'>]</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span>  <span class='co'>#remove row number 1 (The intercept) </span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/aes.html'>aes</a></span><span class='op'>(</span>x<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>variable</span>, <span class='va'>Beta</span><span class='op'>)</span>, y<span class='op'>=</span><span class='va'>Beta</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_point.html'>geom_point</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>15</span>,</span>
<span>             size  <span class='op'>=</span> <span class='fl'>4</span>, width <span class='op'>=</span> <span class='fl'>0.1</span>,</span>
<span>             position <span class='op'>=</span> <span class='st'>"dodge"</span>, color<span class='op'>=</span><span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_linerange.html'>geom_errorbar</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/aes.html'>aes</a></span><span class='op'>(</span>ymin  <span class='op'>=</span> <span class='va'>lower_bound</span>,</span>
<span>                    ymax  <span class='op'>=</span> <span class='va'>upper_bound</span><span class='op'>)</span>,</span>
<span>                width <span class='op'>=</span> <span class='fl'>0.2</span>,</span>
<span>                size  <span class='op'>=</span> <span class='fl'>1</span>,</span>
<span>                position <span class='op'>=</span> <span class='st'>"dodge"</span>, color<span class='op'>=</span><span class='st'>"turquoise4"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/theme.html'>theme</a></span><span class='op'>(</span>axis.title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/element.html'>element_text</a></span><span class='op'>(</span>face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Variables"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Beta coeffecients with 95% CI"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/coord_flip.html'>coord_flip</a></span><span class='op'>(</span>ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>2.5</span>, <span class='fl'>1.6</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>0</span>, color <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>   <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/theme.html'>theme</a></span><span class='op'>(</span>axis.title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>17</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/theme.html'>theme</a></span><span class='op'>(</span>axis.text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span><span class='op'>)</span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>plot_lm</span></span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-20-1.png" width="624" /></p>
</div>
<p>The y-axis tick labels can be improved to correctly define the names. I can do that by bz renaming mz axis tick-labels in my ggplot code.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_lm</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"statusDeveloping"</span>, </span>
<span>                                    <span class='st'>"thinness_1_19_years"</span>, <span class='st'>"alcohol"</span>,</span>
<span>                                    <span class='st'>"adult_mortality"</span>,<span class='st'>"total_expenditure"</span>, </span>
<span>                                    <span class='st'>"infant_deaths"</span>, <span class='st'>"schooling"</span><span class='op'>)</span>,</span>
<span>                           labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Developing countries"</span>, <span class='st'>"Thinness 1-19 yrs"</span>, </span>
<span>                                      <span class='st'>"Alcohol consumption"</span>, </span>
<span>                                      <span class='st'>"Adult MR"</span>, <span class='st'>"Total expenditure"</span>,</span>
<span>                                      <span class='st'>"IMR"</span>, </span>
<span>                                      <span class='st'>"Average school yrs"</span><span class='op'>)</span><span class='op'>)</span> </span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-21-1.png" width="624" /></p>
</div>
<p>There are also a handful of specialized r packages which are dedicated to do this job with a much shorter lines of codes. In the following part, I will use some of the packages to plot my model coefficients. Of the many packages available, <code>broom.mixed</code>, and <code>sJPlot</code>, <code>coefplot</code>,<code>dotwhisker</code>, <code>modelsummary</code>, etc are some of them. I will try broom.mixed and sJPlot</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/bbolker/broom.mixed'>broom.mixed</a></span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/jtools/man/plot_summs.html'>plot_summs</a></span><span class='op'>(</span><span class='va'>lm3</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>, size<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span> </span></code></pre>
</div>
<img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-22-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/jtools/man/plot_summs.html'>plot_summs</a></span><span class='op'>(</span><span class='va'>lm1</span>, scale <span class='op'>=</span> <span class='cn'>TRUE</span>, plot.distributions <span class='op'>=</span> <span class='cn'>TRUE</span>, </span>
<span>           inner_ci_level <span class='op'>=</span> <span class='fl'>.9</span>,</span>
<span>           color.class <span class='op'>=</span> <span class='st'>"darkgreen"</span><span class='op'>)</span> </span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-22-2.png" width="624" /></p>
</div>
<p>One advantage of <code>broom.mixed</code>is it helps you visualize the distribution of the variable and besides the coefficient and the confidence interval. That helps to have a rough overview of normality.</p>
<p>The variable names in the plots can be edited. But, for the sake of time, I am not going to do that.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://strengejacke.github.io/sjPlot/'>sjPlot</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/sjPlot/man/plot_model.html'>plot_model</a></span><span class='op'>(</span><span class='va'>lm3</span>, show.values <span class='op'>=</span> <span class='cn'>TRUE</span>, value.offset <span class='op'>=</span> <span class='fl'>0.3</span>,</span>
<span>           axis.labels<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Developing countries"</span>, <span class='st'>"Alcohol consumption"</span>,</span>
<span>                         <span class='st'>"Thinness 1-19 yrs"</span>,<span class='st'>"IMR"</span>, <span class='st'>"Adult MR"</span>,<span class='st'>"Total expenditure"</span>,</span>
<span>                         <span class='st'>"Average school yrs"</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-23-1.png" width="624" data-distill-preview=1 /></p>
</div>
<p>With SjPlot, it is much easier to label the coefficients in the plot.</p>
<h1 id="one-more-tip">One more tip</h1>
<p>This is not the same regression as we did above. I used a new set of predictors. The following package can do the modeling calculation, tabulation and plotting all together. For linear regression, you can use coef_plot, for logistic regression or_plot, and hr_plot for hazard ratios, etc. I recently discovered this package in stack overflow.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/ewenharrison/finalfit'>finalfit</a></span><span class='op'>)</span> </span>
<span></span>
<span><span class='va'>explanatory</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span> <span class='st'>"alcohol"</span>,</span>
<span>                <span class='st'>"thinness_1_19_years"</span>, </span>
<span>                <span class='st'>"hiv_aids"</span>, </span>
<span>                <span class='st'>"total_expenditure"</span>, <span class='st'>"schooling"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>dependent</span> <span class='op'>=</span> <span class='st'>"life_expectancy"</span></span>
<span></span>
<span></span>
<span><span class='va'>life_exp_new</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span></span>
<span> <span class='fu'><a href='https://rdrr.io/pkg/finalfit/man/coefficient_plot.html'>coefficient_plot</a></span><span class='op'>(</span><span class='va'>dependent</span>, <span class='va'>explanatory</span>, table_text_size<span class='op'>=</span><span class='fl'>3</span>, </span>
<span>                  title_text_size<span class='op'>=</span><span class='fl'>12</span>,</span>
<span>                   plot_opts<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Beta, 95% CI"</span><span class='op'>)</span>, </span>
<span>                                  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/theme.html'>theme</a></span><span class='op'>(</span>axis.title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/element.html'>element_text</a></span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>12</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-24-1.png" width="624" /></p>
</div>
<p>But, is linear regression model the right choice for our data. Did my model pass all key assumptions. I don’t think so. Before I do anything I need to check whether the linear regression assumptions are fulfilled. To reject or accept our model, it must pass all the relevant assumptions. <code>gvlma</code> is a good package for checking that.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>gvlma</span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/gvlma/man/gvlma.html'>gvlma</a></span><span class='op'>(</span><span class='va'>lm3</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
Call:
lm(formula = life_expectancy ~ total_expenditure + schooling + 
    adult_mortality + infant_deaths + thinness_1_19_years + alcohol + 
    status, data = life_exp_new)

Coefficients:
        (Intercept)    total_expenditure            schooling  
         59.1795303           -0.0267339            1.5582409  
    adult_mortality        infant_deaths  thinness_1_19_years  
         -0.0325335            0.0006165           -0.2137415  
            alcohol     statusDeveloping  
         -0.1458388           -1.7250085  


ASSESSMENT OF THE LINEAR MODEL ASSUMPTIONS
USING THE GLOBAL TEST ON 4 DEGREES-OF-FREEDOM:
Level of Significance =  0.05 

Call:
 gvlma(x = lm3) 

                     Value   p-value                   Decision
Global Stat        1729.57 0.000e+00 Assumptions NOT satisfied!
Skewness            409.04 0.000e+00 Assumptions NOT satisfied!
Kurtosis           1245.83 0.000e+00 Assumptions NOT satisfied!
Link Function        37.21 1.059e-09 Assumptions NOT satisfied!
Heteroscedasticity   37.49 9.187e-10 Assumptions NOT satisfied!</code></pre>
</div>
<p>All of the linear regression assumptions are violated. The above model is incorrect. Therefore, I have to decide whether to transform my data using transformation methods or go for other models. Let me check some details about the dependent variable using the <em>psych</em> package,</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span><span class='op'>(</span><span class='va'>life_exp_narm</span><span class='op'>$</span><span class='va'>life_expectancy</span><span class='op'>)</span></span></code></pre>
</div>
<img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-26-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://personality-project.org/r/psych/'>psych</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/psych/man/describe.html'>describe</a></span><span class='op'>(</span><span class='va'>life_exp_narm</span><span class='op'>$</span><span class='va'>life_expectancy</span><span class='op'>)</span> <span class='co'>#skewness -0.63, negatively skewed</span></span></code></pre>
</div>
<pre><code>   vars    n mean  sd median trimmed  mad min max range  skew
X1    1 1649 69.3 8.8   71.7   69.91 7.56  44  89    45 -0.63
   kurtosis   se
X1     0.03 0.22</code></pre>
</div>
<p>My dependent variable is negatively(left) skewed. For left(negatively) skewed distribution, square root, cube root or logarithmic transformation can help me achieve normality. I will check that one by one using qqplot. But, for a nicer version of qqplots, I prefer to use the <code>ggpubr</code> package.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rpkgs.datanovia.com/ggpubr/'>ggpubr</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/pkg/ggpubr/man/ggqqplot.html'>ggqqplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_expectancy</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-27-1.png" width="624" /></p>
</div>
<p>The qqplots above show many of the points fall outside the reference line indicating the data is not normally distributed. Let me transform all of them using square root, cube root and logarithm and investigate qqplots. After that, I will run shapiro wilk normality test.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://rpkgs.datanovia.com/ggpubr/'>ggpubr</a></span><span class='op'>)</span></span>
<span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://patchwork.data-imaginist.com'>patchwork</a></span><span class='op'>)</span></span>
<span><span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ggpubr/man/ggqqplot.html'>ggqqplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_expectancy</span><span class='op'>)</span><span class='op'>)</span></span>
<span><span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ggpubr/man/ggqqplot.html'>ggqqplot</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_expectancy</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span><span class='op'>)</span></span>
<span><span class='va'>p3</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ggpubr/man/ggqqplot.html'>ggqqplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_expectancy</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>p1</span> <span class='op'>+</span> <span class='va'>p2</span> <span class='op'>+</span> <span class='va'>p3</span></span></code></pre>
</div>
<img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-28-1.png" width="624" />
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/shapiro.test.html'>shapiro.test</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>sqrt</a></span><span class='op'>(</span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_expectancy</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
    Shapiro-Wilk normality test

data:  sqrt(life_exp_new$life_expectancy)
W = 0.94587, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/shapiro.test.html'>shapiro.test</a></span><span class='op'>(</span><span class='op'>(</span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_expectancy</span><span class='op'>)</span><span class='op'>^</span><span class='fl'>1</span><span class='op'>/</span><span class='fl'>3</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
    Shapiro-Wilk normality test

data:  (life_exp_new$life_expectancy)^1/3
W = 0.9605, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/stats/shapiro.test.html'>shapiro.test</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_expectancy</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
    Shapiro-Wilk normality test

data:  log(life_exp_new$life_expectancy)
W = 0.92811, p-value &lt; 2.2e-16</code></pre>
</div>
<p>Apparently, the p-values for Shapiro Wilk normality test for all transformed data are rather much lower than 0.05. The null hypothesis (H0) of Shapiro test is “data is normally distributed”. Therefore, we will need to reject the null hypothesis and conclude the data is not normally distributed. A pity!</p>
<p>With that we can reject our model(lm3) and it is not relevant for our data. I am now done with linear models here. I am angry at them. What else can I do? There are many many alternatives. For example: Logistic regression. But, I should get my data ready for that.</p>
<h1 id="logistic-regression">Logistic regression</h1>
<p>I will use <code>glm</code> function to run logistic regression. However, I need to dichotomize my life expectancy variable into high and low life expectancy categories and attach numeric value label my binary category(something like: high,low/1,0. I need to split my outcome variable into two categories: high and low. Since, the data doesn’t follow normal distribution as evidenced above, I should use median split which means every life expectancy value above the median will have “high” label else “low” label.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_expectancy</span><span class='op'>)</span> <span class='co'>#median is 71.8</span></span></code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  44.00   64.60   71.80   69.39   75.00   89.00 </code></pre>
</div>
<p>Median split</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_exp_cat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_expectancy</span> <span class='op'>&lt;=</span> <span class='fl'>71.8</span>, <span class='st'>"0"</span>, <span class='st'>"1"</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_exp_cat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_exp_cat</span>, levels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>,<span class='fl'>1</span><span class='op'>)</span>,</span>
<span>                    labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"low"</span>, <span class='st'>"high"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/table.html'>table</a></span><span class='op'>(</span><span class='va'>life_exp_new</span><span class='op'>$</span><span class='va'>life_exp_cat</span><span class='op'>)</span> </span></code></pre>
</div>
<pre><code>
 low high 
 802  799 </code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>logistic_reg</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/glm.html'>glm</a></span><span class='op'>(</span><span class='va'>life_exp_cat</span> <span class='op'>~</span> <span class='va'>total_expenditure</span> <span class='op'>+</span> </span>
<span>             <span class='va'>schooling</span> <span class='op'>+</span> <span class='va'>adult_mortality</span> <span class='op'>+</span> <span class='va'>infant_deaths</span> <span class='op'>+</span> <span class='va'>thinness_1_19_years</span> <span class='op'>+</span></span>
<span>            <span class='va'>alcohol</span> <span class='op'>+</span> <span class='va'>status</span>, data<span class='op'>=</span><span class='va'>life_exp_new</span>, family <span class='op'>=</span> <span class='va'>binomial</span><span class='op'>)</span></span>
<span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>logistic_reg</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>
Call:
glm(formula = life_exp_cat ~ total_expenditure + schooling + 
    adult_mortality + infant_deaths + thinness_1_19_years + alcohol + 
    status, family = binomial, data = life_exp_new)

Deviance Residuals: 
    Min       1Q   Median       3Q      Max  
-3.1008  -0.4497  -0.0110   0.5094   2.2990  

Coefficients:
                      Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)         -7.0055557  0.8329181  -8.411  &lt; 2e-16 ***
total_expenditure    0.1157071  0.0398235   2.905  0.00367 ** 
schooling            0.7555904  0.0566505  13.338  &lt; 2e-16 ***
adult_mortality     -0.0128377  0.0010746 -11.946  &lt; 2e-16 ***
infant_deaths       -0.0009023  0.0009796  -0.921  0.35704    
thinness_1_19_years -0.0633472  0.0215176  -2.944  0.00324 ** 
alcohol             -0.0547746  0.0278457  -1.967  0.04917 *  
statusDeveloping    -0.4520548  0.3583898  -1.261  0.20718    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2219.5  on 1600  degrees of freedom
Residual deviance: 1097.5  on 1593  degrees of freedom
AIC: 1113.5

Number of Fisher Scoring iterations: 6</code></pre>
</div>
<h1 id="extract-odds-ratios-and-confidence-intervals">Extract Odds ratios and confidence intervals</h1>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='http://www.stats.ox.ac.uk/pub/MASS4/'>MASS</a></span><span class='op'>)</span></span>
<span><span class='va'>or_CI</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/Log.html'>exp</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/coef.html'>coef</a></span><span class='op'>(</span><span class='va'>logistic_reg</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/stats/confint.html'>confint</a></span><span class='op'>(</span><span class='va'>logistic_reg</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>, digits<span class='op'>=</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/r/base/as.data.frame.html'>as.data.frame</a></span><span class='op'>(</span><span class='op'>)</span></span>
<span></span>
<span><span class='va'>or_CI</span> <span class='op'>&lt;-</span> <span class='va'>or_CI</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/dplyr/man/mutate.html'>mutate</a></span><span class='op'>(</span>variable<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span><span class='op'>(</span><span class='va'>or_CI</span><span class='op'>)</span><span class='op'>)</span> <span class='co'># extract the variables from rownames</span></span>
<span>  </span>
<span></span>
<span><span class='va'>or_CI</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/plyr/man/rename.html'>rename</a></span><span class='op'>(</span><span class='va'>or_CI</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"V1"</span> <span class='op'>=</span> <span class='st'>"AOR"</span>,</span>
<span>                        `2.5 %` <span class='op'>=</span> <span class='st'>"lower_bound"</span>,</span>
<span>                        `97.5 %` <span class='op'>=</span> <span class='st'>"upper_bound"</span><span class='op'>)</span><span class='op'>)</span></span>
<span></span>
<span><span class='co'># We don't need to plot the intercept. We can remove it from our data</span></span>
<span></span>
<span></span>
<span><span class='co'># Reorder variables</span></span>
<span><span class='va'>col_order</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"variable"</span>, <span class='st'>"AOR"</span>, <span class='st'>"lower_bound"</span>, <span class='st'>"upper_bound"</span><span class='op'>)</span></span>
<span><span class='va'>or_CI</span> <span class='op'>&lt;-</span> <span class='va'>or_CI</span><span class='op'>[</span>, <span class='va'>col_order</span><span class='op'>]</span> <span class='co'>#reorder variables in the data frame</span></span></code></pre>
</div>
</div>
<p>Now, I can plot the odds ratios and confidence intervals exactly as I did for my linear model coefficients.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_logit_model</span> <span class='op'>&lt;-</span> <span class='va'>or_CI</span><span class='op'>[</span><span class='op'>-</span><span class='fl'>1</span>,<span class='op'>]</span> <span class='op'><a href='https://rdrr.io/pkg/magrittr/man/pipe.html'>%&gt;%</a></span>  <span class='co'>#remove row number 1 (The intercept) </span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/aes.html'>aes</a></span><span class='op'>(</span>x <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>variable</span>, <span class='va'>AOR</span><span class='op'>)</span>, y <span class='op'>=</span> <span class='va'>AOR</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_point.html'>geom_point</a></span><span class='op'>(</span>shape <span class='op'>=</span> <span class='fl'>15</span>,</span>
<span>             size  <span class='op'>=</span> <span class='fl'>4</span>, width <span class='op'>=</span> <span class='fl'>0.1</span>,</span>
<span>             position <span class='op'>=</span> <span class='st'>"dodge"</span>, color<span class='op'>=</span><span class='st'>"black"</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_linerange.html'>geom_errorbar</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/aes.html'>aes</a></span><span class='op'>(</span>ymin  <span class='op'>=</span> <span class='va'>lower_bound</span>,</span>
<span>                    ymax  <span class='op'>=</span> <span class='va'>upper_bound</span><span class='op'>)</span>,</span>
<span>                width <span class='op'>=</span> <span class='fl'>0.2</span>,</span>
<span>                size  <span class='op'>=</span> <span class='fl'>0.7</span>,</span>
<span>                position <span class='op'>=</span> <span class='st'>"dodge"</span>, color<span class='op'>=</span><span class='st'>"turquoise4"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/theme.html'>theme</a></span><span class='op'>(</span>axis.title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/element.html'>element_text</a></span><span class='op'>(</span>face <span class='op'>=</span> <span class='st'>"bold"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/labs.html'>xlab</a></span><span class='op'>(</span><span class='st'>"Variables"</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/labs.html'>ylab</a></span><span class='op'>(</span><span class='st'>"Adjusted odds ratios with 95% CI"</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/coord_flip.html'>coord_flip</a></span><span class='op'>(</span>ylim <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2.5</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/geom_abline.html'>geom_hline</a></span><span class='op'>(</span>yintercept <span class='op'>=</span> <span class='fl'>1</span>, color <span class='op'>=</span> <span class='st'>"red"</span>, size <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span></span>
<span>   <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/theme.html'>theme</a></span><span class='op'>(</span>axis.title <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>17</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> </span>
<span>  <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/theme.html'>theme</a></span><span class='op'>(</span>axis.text <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span><span class='op'>)</span><span class='op'>)</span> </span>
<span><span class='va'>plot_logit_model</span></span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-33-1.png" width="624" /></p>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='va'>plot_logit_model</span> <span class='op'>+</span> <span class='fu'><a href='https://rdrr.io/pkg/ggplot2/man/scale_discrete.html'>scale_x_discrete</a></span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"statusDeveloping"</span>, <span class='st'>"alcohol"</span>,</span>
<span>                                    <span class='st'>"thinness_1_19_years"</span>, </span>
<span>                                    <span class='st'>"adult_mortality"</span>,<span class='st'>"infant_deaths"</span>,</span>
<span>                                    <span class='st'>"total_expenditure"</span>, <span class='st'>"schooling"</span><span class='op'>)</span>,</span>
<span>                           </span>
<span>                           labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Developing countries"</span>, <span class='st'>"Alcohol consumption"</span>,</span>
<span>                                      <span class='st'>"Thinness 1-19 yrs"</span>, </span>
<span>                                      <span class='st'>"Adult mortality"</span>, <span class='st'>"Infant mortality"</span>, </span>
<span>                                      <span class='st'>"Total expenditure"</span>,</span>
<span>                                      <span class='st'>"Average school yrs"</span><span class='op'>)</span><span class='op'>)</span> </span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-34-1.png" width="624" /></p>
</div>
<p>Or just simply using the <em>sjPlot</em> package</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='fu'><a href='https://rdrr.io/pkg/sjPlot/man/plot_model.html'>plot_model</a></span><span class='op'>(</span><span class='va'>logistic_reg</span>, show.values <span class='op'>=</span> <span class='cn'>TRUE</span>, value.offset <span class='op'>=</span> <span class='fl'>.3</span>, vline.color <span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span></span></code></pre>
</div>
<p><img src="2020-09-30-plotting-model-coefficients-in-a-forest-plot_files/figure-html5/unnamed-chunk-35-1.png" width="624" /></p>
</div>
<h1 id="evaluation-of-model-performance">Evaluation of model performance</h1>
<p>A widely approach to assess model performance is to assess prediction accuracy via <em>loss functions</em> in cross-validated samples.</p>
<p>We can use the models for predictions.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/topepo/caret/'>caret</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span> <span class='co'>#for reproducibility</span></span>
<span><span class='op'>(</span><span class='va'>cv_lm</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/pkg/caret/man/train.html'>train</a></span><span class='op'>(</span><span class='va'>life_expectancy</span> <span class='op'>~</span> <span class='va'>total_expenditure</span> <span class='op'>+</span> </span>
<span>             <span class='va'>schooling</span> <span class='op'>+</span> <span class='va'>adult_mortality</span> <span class='op'>+</span> <span class='va'>infant_deaths</span> <span class='op'>+</span> <span class='va'>thinness_1_19_years</span> <span class='op'>+</span></span>
<span>            <span class='va'>alcohol</span> <span class='op'>+</span> <span class='va'>status</span>, data<span class='op'>=</span><span class='va'>life_exp_new</span>, </span>
<span>            method<span class='op'>=</span><span class='st'>"lm"</span>, </span>
<span>            trControl <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/trainControl.html'>trainControl</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"cv"</span>, number<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Linear Regression 

1601 samples
   7 predictor

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1442, 1441, 1441, 1440, 1439, 1442, ... 
Resampling results:

  RMSE     Rsquared   MAE     
  4.57687  0.7336561  3.325222

Tuning parameter &#39;intercept&#39; was held constant at a value of TRUE</code></pre>
</div>
<p>How do you interpret the above cross validated loss functions(eg.RMSE)?</p>
<p>If the linear model is applied to unseen data, it will predict life expectancy about 4.6 years off from the actual life expectancy of a country. That was great. Unfortunately, the model did not satisfy the assumptions. Let’s now evaluate our logistic regression</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/topepo/caret/'>caret</a></span><span class='op'>)</span></span>
<span><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>123</span><span class='op'>)</span></span>
<span><span class='op'>(</span><span class='va'>cv_logit</span> <span class='op'>&lt;-</span>  <span class='fu'><a href='https://rdrr.io/pkg/caret/man/train.html'>train</a></span><span class='op'>(</span><span class='va'>life_exp_cat</span> <span class='op'>~</span> <span class='va'>total_expenditure</span> <span class='op'>+</span> </span>
<span>             <span class='va'>schooling</span> <span class='op'>+</span> <span class='va'>adult_mortality</span> <span class='op'>+</span> <span class='va'>infant_deaths</span> <span class='op'>+</span> <span class='va'>thinness_1_19_years</span> <span class='op'>+</span></span>
<span>            <span class='va'>alcohol</span> <span class='op'>+</span> <span class='va'>status</span>, data<span class='op'>=</span><span class='va'>life_exp_new</span>, </span>
<span>            method<span class='op'>=</span><span class='st'>"glm"</span>, </span>
<span>            trControl <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/caret/man/trainControl.html'>trainControl</a></span><span class='op'>(</span>method<span class='op'>=</span><span class='st'>"cv"</span>, number<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span></span></code></pre>
</div>
<pre><code>Generalized Linear Model 

1601 samples
   7 predictor
   2 classes: &#39;low&#39;, &#39;high&#39; 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 1441, 1441, 1441, 1441, 1441, 1441, ... 
Resampling results:

  Accuracy   Kappa    
  0.8451165  0.6902183</code></pre>
</div>
<p>The logistic regression model predicts the data with 84.5% accuracy. Ideally, we have to split the data into test and train set and perform the performance evaluation and tabulate results using confusion matrix functions.</p>
<p>Yes, I did it. Thank you for reading this post. In my next blog post, will write about more advanced generalized linear models(Lasso, ridge and elastic net).</p>
<figure>
<img src="https://media.tenor.com/images/ed15fe5ceca132793f32df5b383a30ed/tenor.gif" width="478" alt="Trains GIFs | Tenor" />
<figcaption aria-hidden="true">Trains GIFs | Tenor</figcaption>
</figure>
<p>Thank you for reading this post. I hope you find this helpful. For more, subscribe to my <a href="https://www.youtube.com/channel/UCpHd6O1Yqz4YgcYUBfyRqKg">YouTube channel</a> and follow me on Twitter @<a href="https://twitter.com/RPy_DataScience">RPy_DataScience</a>.You can also follow me by liking <a href="https://web.facebook.com/R_Py-Data-Science-105325938441990/news_feed">R_Py Data Science</a> Facebook page.</p>
<h1 id="contact"><strong>Contact</strong></h1>
<p>Please mention @<a href="https://twitter.com/RPy_DataScience">RPy_DataScience</a> if you tweet this post.</p>
<p>If you have enjoyed reading this blog post, consider subscribing for upcoming posts.</p>
<div class="layout-chunk" data-layout="l-body">
<form action="https://mihiretukebede.us18.list-manage.com/subscribe/post?u=7996931f0da3fa21654a3274b&amp;id=a7cc1788e4&amp;f_id=00252de7f0" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
  <div id="mc_embed_signup_scroll">
    <h2>Subscribe</h2>
    <div class="indicates-required"><span class="asterisk">*</span> indicates required</div>
    <div class="mc-field-group">
      <label for="mce-EMAIL">Email Address  <span class="asterisk">*</span></label>
      <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" required>
      <span id="mce-EMAIL-HELPERTEXT" class="helper_text"></span>
    </div>
    <div id="mce-responses" class="clear foot">
      <div class="response" id="mce-error-response" style="display:none"></div>
      <div class="response" id="mce-success-response" style="display:none"></div>
    </div>  
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_7996931f0da3fa21654a3274b_a7cc1788e4" tabindex="-1" value=""></div>
    <div class="optionalParent">
      <div class="clear foot">
        <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
        <p class="brandingLogo"><a href="http://eepurl.com/ioaw72" title="Mailchimp - email marketing made easy and fun"><img src="https://eep.io/mc-cdn-images/template_images/branding_logo_text_dark_dtp.svg"></a></p>
      </div>
    </div>
  </div>
</form>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Plotting%20regression%20model%20coefficients%20in%20a%20forest%20plot&amp;url=http%3A%2F%2Fwww.mihiretukebede.com%2Fposts%2F2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot%2F" aria-label="share on twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Fwww.mihiretukebede.com%2Fposts%2F2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot%2F&amp;title=Plotting%20regression%20model%20coefficients%20in%20a%20forest%20plot" aria-label="share on linkedin">
        <i class="fab fa-linkedin" aria-hidden="true"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=http%3A%2F%2Fwww.mihiretukebede.com%2Fposts%2F2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot%2F" aria-label="share on facebook">
        <i class="fab fa-facebook" aria-hidden="true"></i>
      </a>
      <a href="https://plus.google.com/share?url=http%3A%2F%2Fwww.mihiretukebede.com%2Fposts%2F2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot%2F" aria-label="share on google-plus">
        <i class="fab fa-google-plus" aria-hidden="true"></i>
      </a>
      <a href="https://pinterest.com/pin/create/link/?url=http%3A%2F%2Fwww.mihiretukebede.com%2Fposts%2F2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot%2F&amp;description=Plotting%20regression%20model%20coefficients%20in%20a%20forest%20plot" aria-label="share on pinterest">
        <i class="fab fa-pinterest" aria-hidden="true"></i>
      </a>
    </span>
  </p>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="citation">Citation</h3>
  <p>For attribution, please cite this work as</p>
  <pre class="citation-appendix short">Kebede(PhD) (2021, Feb. 4). Aspire Data Solutions: Plotting regression model coefficients in a forest plot. Retrieved from http://www.mihiretukebede.com/posts/2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot/</pre>
  <p>BibTeX citation</p>
  <pre class="citation-appendix long">@misc{kebede(phd)2021plotting,
  author = {Kebede(PhD), Mihiretu},
  title = {Aspire Data Solutions: Plotting regression model coefficients in a forest plot},
  url = {http://www.mihiretukebede.com/posts/2020-09-30-2020-09-30-plotting-model-coefficients-in-a-forest-plot/},
  year = {2021}
}</pre>
</div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
